<!DOCTYPE html>
<html lang="ko">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="../../assets/style-guide.css">
	<title>Password</title>
</head>
<body>
  <div class="container container--no-header">
    <h1 class="t-title-1 guide-title">Password 컴포넌트</h1>
    
    <h2 class="t-title-2 guide-title">비밀번호 구성 요소</h2>

    <section class="guide-section">
      <div class="guide-article">
        <h3 class="t-title-3 guide-subtitle">기본 비밀번호</h3>
        <p class="guide-subtitle">비밀번호 입력 필드로, placeholder와 disabled 상태를 지원합니다. (회원가입/변경 화면 예시: <code>autocomplete="new-password"</code> · 로그인 화면은 <code>current-password</code> 권장)</p>

        <div class="guide-component-group block">
          <form class="fd-form">
            <div class="grid grid-cols-4 md:grid-cols-8 lg:grid-cols-12">
              <!-- 기본 -->
              <div class="fd-field col-span-4 md:col-span-4 lg:col-span-4">
                <label for="f-password-1" class="fd-field__lbl">비밀번호 입력</label>
                <div class="fd-field__ctrl fd-field__ctrl--pw">
                  <div class="fd-pw fd-pw--full">
                    <input id="f-password-1" name="password" type="password" class="fd-pw__el"
                           placeholder="비밀번호를 입력하세요" required minlength="8" autocomplete="new-password">
                    <button type="button" class="fd-pw__toggle" aria-pressed="false" data-password-toggle>
                      <span class="visually-hidden">비밀번호 보기</span>
                      <i class="icon-bg icon-pw-hide" aria-hidden="true"></i>
                    </button>
                  </div>
                </div>
              </div>

              <!-- 비활성화 -->
              <div class="fd-field col-span-4 md:col-span-4 lg:col-span-4">
                <label for="f-password-2" class="fd-field__lbl">비밀번호 입력 비활성화</label>
                <div class="fd-field__ctrl fd-field__ctrl--pw">
                  <div class="fd-pw fd-pw--full">
                    <input id="f-password-2" type="password" class="fd-pw__el" value="password"
                           autocomplete="new-password" disabled>
                    <button type="button" class="fd-pw__toggle" aria-pressed="false" data-password-toggle disabled>
                      <span class="visually-hidden">비밀번호 보기</span>
                      <i class="icon-bg icon-pw-hide" aria-hidden="true"></i>
                    </button>
                  </div>
                </div>
              </div>

              <div class="fd-field col-span-4 md:col-span-4 lg:col-span-4">
                <label for="f-password-4" class="fd-field__lbl">비밀번호 입력 (버튼 조합)</label>
                <div class="fd-field__ctrl fd-field__ctrl--pw fd-field__ctrl--with-button">
                  <div class="fd-pw fd-pw--full">
                    <input id="f-password-4" name="password" type="password" class="fd-pw__el"
                           placeholder="비밀번호를 입력하세요" required minlength="8" autocomplete="new-password">
                    <button type="button" class="fd-pw__toggle" aria-pressed="false" data-password-toggle>
                      <span class="visually-hidden">비밀번호 보기</span>
                      <i class="icon-bg icon-pw-hide" aria-hidden="true"></i>
                    </button>
                  </div>
                  <button type="button" class="fd-field__btn btn btn--solid">버튼</button>
                </div>
              </div>

            </div>
          </form>
        </div>

        <!-- 표시용 코드 블록 (이스케이프 버전) -->
        <div class="guide-code-block">
<pre><code>&lt;form class="fd-form"&gt;
  &lt;div class="fd-field"&gt;
    &lt;label for="f-password" class="fd-field__lbl"&gt;비밀번호 입력&lt;/label&gt;
    &lt;div class="fd-field__ctrl fd-field__ctrl--pw"&gt;
      &lt;div class="fd-pw fd-pw--full"&gt;
        &lt;input id="f-password" type="password" class="fd-pw__el"
               placeholder="비밀번호를 입력하세요" required minlength="8" autocomplete="new-password"&gt;
        &lt;button type="button" class="fd-pw__toggle" aria-pressed="false" data-password-toggle&gt;
          &lt;span class="visually-hidden"&gt;비밀번호 보기&lt;/span&gt;
          &lt;i class="icon-bg icon-pw-hide" aria-hidden="true"&gt;&lt;/i&gt;
        &lt;/button&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;

  &lt;div class="fd-field"&gt;
    &lt;label for="f-password-disabled" class="fd-field__lbl"&gt;비밀번호 입력 비활성화&lt;/label&gt;
    &lt;div class="fd-field__ctrl fd-field__ctrl--pw"&gt;
      &lt;div class="fd-pw fd-pw--full"&gt;
        &lt;input id="f-password-disabled" type="password" class="fd-pw__el" value="password"
               autocomplete="new-password" disabled&gt;
        &lt;button type="button" class="fd-pw__toggle" aria-pressed="false" data-password-toggle disabled&gt;
          &lt;span class="visually-hidden"&gt;비밀번호 보기&lt;/span&gt;
          &lt;i class="icon-bg icon-pw-hide" aria-hidden="true"&gt;&lt;/i&gt;
        &lt;/button&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;

  &lt;div class="fd-field"&gt;
    &lt;label for="f-password" class="fd-field__lbl"&gt;비밀번호 입력 (버튼 조합)&lt;/label&gt;
    &lt;div class="fd-field__ctrl fd-field__ctrl--pw fd-field__ctrl--with-button"&gt;
      &lt;div class="fd-pw fd-pw--full"&gt;
        &lt;input id="f-password" type="password" class="fd-pw__el"
               placeholder="비밀번호를 입력하세요" required minlength="8" autocomplete="new-password"&gt;
        &lt;button type="button" class="fd-pw__toggle" aria-pressed="false" data-password-toggle&gt;
          &lt;span class="visually-hidden"&gt;비밀번호 보기&lt;/span&gt;
          &lt;i class="icon-bg icon-pw-hide" aria-hidden="true"&gt;&lt;/i&gt;
        &lt;/button&gt;
      &lt;/div&gt;
      &lt;button type="button" class="fd-field__btn btn btn--solid"&gt;버튼&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/form&gt;</code></pre>
        </div>
      </div>

      <div class="guide-article">
        <h3 class="t-title-3 guide-subtitle">도움말 메세지</h3>
        <p class="guide-subtitle">비밀번호 입력 필드에 도움말 메세지를 표시할 수 있습니다.</p>

        <div class="guide-component-group block">
          <form class="fd-form">
            <div class="grid grid-cols-4 md:grid-cols-8 lg:grid-cols-12">
              <div class="fd-field col-span-4 md:col-span-4 lg:col-span-6">
                <label for="f-password-3" class="fd-field__lbl">비밀번호 확인</label>
                <div class="fd-field__ctrl fd-field__ctrl--pw">
                  <div class="fd-pw fd-pw--full">
                    <input id="f-password-3" name="passwordConfirm" type="password" class="fd-pw__el"
                           placeholder="비밀번호를 다시 입력하세요" required minlength="8"
                           autocomplete="new-password" aria-describedby="f-password-msg-3">
                    <button type="button" class="fd-pw__toggle" aria-pressed="false" data-password-toggle>
                      <span class="visually-hidden">비밀번호 보기</span>
                      <i class="icon-bg icon-pw-hide" aria-hidden="true"></i>
                    </button>
                  </div>
                </div>
                <!-- 도움말 영역 -->
                <p id="f-password-msg-3" class="fd-field__msg">*비밀번호는 8자 이상 입력해주세요.</p>
              </div>
            </div>
          </form>
        </div>

        <!-- 표시용 코드 블록 (이스케이프 버전) -->
        <div class="guide-code-block">
<pre><code>&lt;form class="fd-form"&gt;
  &lt;div class="fd-field"&gt;
    &lt;label for="f-password" class="fd-field__lbl"&gt;비밀번호 확인&lt;/label&gt;
    &lt;div class="fd-field__ctrl fd-field__ctrl--pw"&gt;
      &lt;div class="fd-pw fd-pw--full"&gt;
        &lt;input id="f-password" type="password" class="fd-pw__el"
               placeholder="비밀번호를 다시 입력하세요" required minlength="8"
               autocomplete="new-password" aria-describedby="f-password-msg-3"&gt;
        &lt;button type="button" class="fd-pw__toggle" aria-pressed="false" data-password-toggle&gt;
          &lt;span class="visually-hidden"&gt;비밀번호 보기&lt;/span&gt;
          &lt;i class="icon-bg icon-pw-hide" aria-hidden="true"&gt;&lt;/i&gt;
        &lt;/button&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;!-- 도움말/오류 영역 --&gt;
    &lt;p id="f-password-msg-3" class="fd-field__msg"&gt;*비밀번호는 8자 이상 입력해주세요.&lt;/p&gt;
  &lt;/div&gt;
&lt;/form&gt;</code></pre>
        </div>
      </div>

      <div class="guide-article">
        <h3 class="t-title-3 guide-subtitle">오류 상태</h3>
        <p class="guide-subtitle">비밀번호 입력 오류 발생 시 시각적으로 강조되며, 오류 메시지를 함께 표시해 사용자의 인지를 돕습니다.</p>

        <div class="guide-component-group">
          <form class="fd-form">
            <div class="fd-field fd-field--error">
              <label for="f-password-error" class="fd-field__lbl">비밀번호</label>
              <div class="fd-field__ctrl fd-field__ctrl--pw">
                <div class="fd-pw fd-pw--full">
                  <input id="f-password-error" name="passwordError" type="password" class="fd-pw__el"
                         placeholder="비밀번호를 입력하세요" required minlength="8"
                         autocomplete="new-password" aria-describedby="f-password-error-msg" aria-invalid="true">
                  <button type="button" class="fd-pw__toggle" aria-pressed="false" data-password-toggle>
                    <span class="visually-hidden">비밀번호 보기</span>
                    <i class="icon-bg icon-pw-hide" aria-hidden="true"></i>
                  </button>
                </div>
              </div>
              <p id="f-password-error-msg" class="fd-field__msg fd-field__msg--error" aria-live="polite">
                *비밀번호 형식이 올바르지 않습니다.
              </p>
            </div>
          </form>
        </div>

        <!-- 표시용 코드 블록 (이스케이프 버전) -->
        <div class="guide-code-block">
<pre><code>&lt;form class="fd-form"&gt;
  &lt;div class="fd-field fd-field--error"&gt;
    &lt;label for="f-password-error" class="fd-field__lbl"&gt;비밀번호&lt;/label&gt;
    &lt;div class="fd-field__ctrl fd-field__ctrl--pw"&gt;
      &lt;div class="fd-pw fd-pw--full"&gt;
        &lt;input id="f-password-error" type="password" class="fd-pw__el"
               placeholder="비밀번호를 입력하세요" required minlength="8"
               autocomplete="new-password" aria-describedby="f-password-error-msg" aria-invalid="true"&gt;
        &lt;button type="button" class="fd-pw__toggle" aria-pressed="false" data-password-toggle&gt;
          &lt;span class="visually-hidden"&gt;비밀번호 보기&lt;/span&gt;
          &lt;i class="icon-bg icon-pw-hide" aria-hidden="true"&gt;&lt;/i&gt;
        &lt;/button&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;!-- 오류 메시지 --&gt;
    &lt;p id="f-password-error-msg" class="fd-field__msg fd-field__msg--error" aria-live="polite"&gt;
      *비밀번호 형식이 올바르지 않습니다.
    &lt;/p&gt;
  &lt;/div&gt;
&lt;/form&gt;</code></pre>
        </div>

        <div class="guide-notice">
          <strong>참고:</strong>
          <code>fd-pw__toggle</code> 버튼 클릭 시 input의 type이 <code>password</code> ↔ <code>text</code>로 토글되고,
          아이콘은 <code>icon-pw-hide</code> ↔ <code>icon-pw-show</code> 클래스로 전환됩니다.
          접근성 이름은 <strong>버튼의 직접 자식</strong> <code>.visually-hidden</code> 텍스트로 제공됩니다.
        </div>
      </div>
    </section>

    <section class="guide-section">
      <h2 class="t-title-2 guide-title">JavaScript 기능</h2>
      <p class="guide-subtitle">
        아래 스크립트는 <strong>비밀번호 토글 버튼</strong> 기능을 제공합니다. 버튼의 접근성 이름(SR 텍스트), 
        <code>aria-pressed</code> 상태, <code>aria-controls</code> 연결과 아이콘 클래스를 함께 갱신합니다.
      </p>
      <div class="guide-notice">
        <strong>참고:</strong>
        <ul class="guide-list">
          <li><strong>초기 연결</strong>: 초기화 시점에 버튼과 입력 요소를 <code>aria-controls</code>로 <strong>한 번</strong> 연결합니다.</li>
          <li><strong>접근성 이름</strong>: 버튼의 직접 자식 <code>&lt;span class="visually-hidden"&gt;</code>으로 스크린리더용 이름을 제공합니다.</li>
          <li><strong>상태 동기화</strong>: 토글 시 버튼의 <code>aria-pressed</code> 값을 현재 표시 상태에 맞게 갱신합니다.</li>
          <li><strong>아이콘 전환</strong>: <code>icon-pw-hide</code> ↔ <code>icon-pw-show</code> 클래스를 전환하고, 아이콘에는 <code>aria-hidden="true"</code>를 유지합니다.</li>
          <li><strong>비활성화 연동</strong>: 입력이 <code>disabled</code>인 경우 토글 버튼도 <code>disabled</code>로 동기화합니다.</li>
          <li><strong>자동완성 가이드</strong>: 로그인 화면은 <code>autocomplete="current-password"</code>, 회원가입/변경 화면은 <code>autocomplete="new-password"</code>를 사용합니다.</li>
        </ul>   
      </div>

      <!-- 표시용 코드 블록 (이스케이프 버전) -->
      <div class="guide-code-block">
<pre><code>&lt;script&gt;
document.addEventListener('DOMContentLoaded', function () {
  const toggles = document.querySelectorAll('[data-password-toggle]');

  toggles.forEach((btn) => {
    // 안전장치: submit 방지
    if (btn.type !== 'button') btn.setAttribute('type', 'button');

    // 1. 접근성 이름: 버튼 직접 자식 SR 텍스트 보장
    if (btn.hasAttribute('aria-label')) btn.removeAttribute('aria-label');
    let sr = btn.querySelector(':scope > .visually-hidden');
    if (!sr) {
      const srInIcon = btn.querySelector('.icon-bg .visually-hidden');
      const text = srInIcon ? srInIcon.textContent.trim() : '비밀번호 보기';
      sr = document.createElement('span');
      sr.className = 'visually-hidden';
      sr.textContent = text || '비밀번호 보기';
      btn.prepend(sr);
      if (srInIcon) srInIcon.remove(); // 중복 제거
    }

    // 2. 아이콘은 SR에서 제외
    const icon = btn.querySelector('.icon-bg');
    if (icon && !icon.hasAttribute('aria-hidden')) {
      icon.setAttribute('aria-hidden', 'true');
    }

    // 3. 초기화 시점에 제어 대상 연결 + 초기 상태 동기화 (추가)
    const container = btn.closest('.fd-pw');
    const input = container ? container.querySelector('.fd-pw__el') : null;
    if (!input) return; // 이 버튼은 스킵

    if (!input.id) {
      input.id = 'pw-' + Math.random().toString(36).slice(2, 8);
    }
    btn.setAttribute('aria-controls', input.id);

    // 초기 aria-pressed / SR 문구 동기화 (현재 타입 기준)
    const isHiddenInit = (input.type === 'password');
    btn.setAttribute('aria-pressed', isHiddenInit ? 'false' : 'true');
    sr.textContent = isHiddenInit ? '비밀번호 보기' : '비밀번호 숨기기';

    // 입력 비활성화 시 버튼도 비활성화 동기화
    if (input.disabled) btn.disabled = true;

    // 4. 클릭 토글
    btn.addEventListener('click', () => {
      const show = (input.type === 'password'); // 보여줄지 여부
      input.type = show ? 'text' : 'password';

      // 아이콘 상태 토글 (replace 우선, 실패 시 폴백)
      if (icon) {
        const from = show ? 'icon-pw-hide' : 'icon-pw-show';
        const to   = show ? 'icon-pw-show' : 'icon-pw-hide';
        if (!icon.classList.replace(from, to)) {
          icon.classList.toggle('icon-pw-hide', !show);
          icon.classList.toggle('icon-pw-show', show);
        }
      }

      // 상태·이름 동기화
      btn.setAttribute('aria-pressed', show ? 'true' : 'false');
      sr.textContent = show ? '비밀번호 숨기기' : '비밀번호 보기';
    });
  });
});
&lt;/script&gt;</code></pre>
      </div>
    </section>
  </div>

  <!-- 실제 동작 스크립트 -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const toggles = document.querySelectorAll('[data-password-toggle]');
    
      toggles.forEach((btn) => {
        // 안전장치: submit 방지
        if (btn.type !== 'button') btn.setAttribute('type', 'button');
    
        // 1. 접근성 이름: 버튼 직접 자식 SR 텍스트 보장
        if (btn.hasAttribute('aria-label')) btn.removeAttribute('aria-label');
        let sr = btn.querySelector(':scope > .visually-hidden');
        if (!sr) {
          const srInIcon = btn.querySelector('.icon-bg .visually-hidden');
          const text = srInIcon ? srInIcon.textContent.trim() : '비밀번호 보기';
          sr = document.createElement('span');
          sr.className = 'visually-hidden';
          sr.textContent = text || '비밀번호 보기';
          btn.prepend(sr);
          if (srInIcon) srInIcon.remove(); // 중복 제거
        }
    
        // 2. 아이콘은 SR에서 제외
        const icon = btn.querySelector('.icon-bg');
        if (icon && !icon.hasAttribute('aria-hidden')) {
          icon.setAttribute('aria-hidden', 'true');
        }
    
        // 3. 초기화 시점에 제어 대상 연결 + 초기 상태 동기화 (추가)
        const container = btn.closest('.fd-pw');
        const input = container ? container.querySelector('.fd-pw__el') : null;
        if (!input) return; // 이 버튼은 스킵
    
        if (!input.id) {
          input.id = 'pw-' + Math.random().toString(36).slice(2, 8);
        }
        btn.setAttribute('aria-controls', input.id);
    
        // 초기 aria-pressed / SR 문구 동기화 (현재 타입 기준)
        const isHiddenInit = (input.type === 'password');
        btn.setAttribute('aria-pressed', isHiddenInit ? 'false' : 'true');
        sr.textContent = isHiddenInit ? '비밀번호 보기' : '비밀번호 숨기기';
    
        // 입력 비활성화 시 버튼도 비활성화 동기화
        if (input.disabled) btn.disabled = true;
    
        // 4. 클릭 토글
        btn.addEventListener('click', () => {
          const show = (input.type === 'password'); // 보여줄지 여부
          input.type = show ? 'text' : 'password';
    
          // 아이콘 상태 토글 (replace 우선, 실패 시 폴백)
          if (icon) {
            const from = show ? 'icon-pw-hide' : 'icon-pw-show';
            const to   = show ? 'icon-pw-show' : 'icon-pw-hide';
            if (!icon.classList.replace(from, to)) {
              icon.classList.toggle('icon-pw-hide', !show);
              icon.classList.toggle('icon-pw-show', show);
            }
          }
    
          // 상태·이름 동기화
          btn.setAttribute('aria-pressed', show ? 'true' : 'false');
          sr.textContent = show ? '비밀번호 숨기기' : '비밀번호 보기';
        });
      });
    });
  </script>    
</body>
</html>
